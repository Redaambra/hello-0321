<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>PHP 23 darbas RB</title>
    <script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
        crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">

    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <style>
        table {
            border: 1px solid black;
        }

        .modal {
            visibility: hidden;
            position: fixed;
            left: 0;
            right: 0;
            top: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;

        }

        .modal .content {
            background-color: white;
            padding: 10px;
            border: 4px solid white;
            border-radius: 4px;
            box-shadow: 1px 1px 4px black;
            height: 100px;
            width: 200px;
            position: absolute;
            top: 300px;
        }

        .modal .content1 {
            background-color: white;
            padding: 10px;
            border: 4px solid white;
            border-radius: 4px;
            box-shadow: 1px 1px 4px black;
            position: absolute;
            top: 100px;
            width: 400px;
        }
    </style>
</head>

<body>
    <div id="container">
        <div></div>
        <br>
        <br>
        <br>
        <button class="btn btn-info btn-lg">Naujas įrašas</button>
        <br>
        <br>
        <br>
        <table class="table">
            <thead>
                <tr class="info">
                    <th>Id</th>
                    <th>Data</th>
                    <th>Numeris</th>
                    <th>Atstumas</th>
                    <th>Laikas</th>
                    <th>Veiksmai</th>
                </tr>
            </thead>
            <tbody>

            </tbody>
        </table>

    </div>
    <!-- modalinis ar trinti -->
    <div class="modal" id="confirm" onclick="closeConfirm()">
        <div class="content">
            <p>Ar tikrai norite istrinti?</p>
            <div>
                <button>Ne</button>
                <button id="confirm-ok">Taip</button>
            </div>
        </div>
    </div>

    <!-- modalinis ivesti nauja eilute -->
    <div class="modal" id="newLine" onclick="closeConfirm()">
        <div class="content1">
            <h4>Suveskite naujus duomenis</h4>
            <form>
                <div class="form-group">
                    <label for="data">Data</label>
                    <input type="date" class="form-control" id="data">
                </div>
                <div class="form-group">
                    <label for="text">numeris:</label>
                    <input type="text" class="form-control" id="numeris" placeholder="ABC123">
                </div>
                <div class="form-group">
                    <label for="atstumas">Atstumas:</label>
                    <input type="number" class="form-control" id="atstumas" placeholder="metrai">
                </div>
                <div class="form-group">
                    <label for="laikas">Laikas:</label>
                    <input type="number" class="form-control" id="laikas" placeholder="sekundės">
                </div>
                <button id="taisyti-ok" class="btn btn-default">Įrašyti</button>
                <button class="btn btn-default">Atšaukti</button>
            </form>
        </div>
    </div>



    <script>
        $(function () {
            gautiLentele();
        });


        function gautiLentele() {
            $.get('lentele.php', function (resp) {
                if (resp.success) {
                    rodytilentele(resp.data);
                } else {
                    $('div').text('kazkokia gauti lentele klaida');
                }
            });
            fail(function () {
                $('div').text('kazkokia rimta klaida');
            });
        }



        function rodytilentele(data) {
            var e = document.querySelector('tbody');
            var txt = '';
            data.forEach(x => {
                txt += '<tr>' +
                    '<td>' + x.id + '</td>' +
                    '<td>' + x.date + '</td>' +
                    '<td>' + x.number + '</td>' +
                    '<td>' + x.distance + '</td>' +
                    '<td>' + x.time + '</td>' +
                    '<td>' +
                    '<button class="btn btn-info btn-sm" onclick="trinti(' + x.id + ')">Trintukas</button>' +
                    '<button class="btn btn-info btn-sm" onclick="taisyti(' + x.id + ')">Pieštukas</button>' +
                    '</td>' +
                    '</tr>';

            });
            e.innerHTML = txt;
        }

        function trinti(autoId) {
            document.getElementById("confirm").style.visibility = 'visible';
            document.getElementById('container').style.filter = 'blur(2px)';

            document.getElementById('confirm-ok').onclick = function () {
                $.get('trinti.php', { id: autoId }, function (resp) {
                    if (resp.success) {
                        gautiLentele();
                    } else {
                        $('div').text('klaida trynimo metu');
                    }
                });
            }
        }

        function closeConfirm() {
            document.getElementById("confirm").style.visibility = 'hidden';
            document.getElementById('container').style.filter = 'blur(0)';
        }

        function taisyti(autoId) {
            document.getElementById("newLine").style.visibility = 'visible';
            document.getElementById('container').style.filter = 'blur(2px)';

            document.getElementById('taisyti-ok').onclick = function () {
                $.get('taisyti.php', { id: autoId }, function (resp) {
                    if (resp.success) {
                        gautiLentele();
                    } else {
                        $('div').text('klaida trynimo metu');
                    }
                });
            }

        }


    </script>
</body>

</html>